---
output: github_document
bibliography: bib.bib
link-citations: true
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
example_data <- read.csv("tests/testthat/test-data/data_1.csv")
```

# Cragg
An R package to implement the Cragg-Donald test for weak instruments.

[![Build Status](https://travis-ci.com/beniaminogreen/cragg.svg?branch=master)](https://travis-ci.com/beniaminogreen/cragg)
![Codecov](https://img.shields.io/codecov/c/github/beniaminogreen/cragg)
[![License: GPL v3](https://img.shields.io/badge/License-GPL%20v3-blue.svg)](https://www.gnu.org/licenses/old-licenses/gpl-3.0.en.html)

## Overview
Cragg is an R package to implement the Cragg-Donald [-@Cragg_1993] test for weak instruments, using critical values from Stock and Yogo [-@Stock_2005].
These tests quantify the degree to which weak instruments can undermine regression estimates for models with multiple endogenous variables / treatments.

### Main Features

* Calculates Cragg-Donald statistics for weak instruments.

* Recommends critical values for the Cragg-Donald Statistic based on the largest allowable bias relative to regular OLS
  or the maximum allowable size distortion of the Wald test statistic.

## Installation
```{r, eval = FALSE}
#install.packages("devtools")
devtools::install_github("beniaminogreen/cragg")
```

## Usage
The cragg package has two main functions `cragg_donald()`,  and `stock_yogo_test()`.

`cragg_donald()` implements the Cragg-Donald test for weak instruments in R. It can be thought of
as the matrix-equivalent of the first-stage F-test for weak instruments, and is used to evaluate models
with multiple endogenous variables. This function has been tested against the results from STATA's ivreg2 package [@ivreg2] to ensure accuracy.
The syntax is show below:

```{r}
library(cragg)
#Cragg-Donald Test
cragg_donald(
	~X1+X2+X3,	#Controls
	~D,			#Treatments
	~Z1 + Z2,	#Instruments
	data =example_data
)
```
`stock_yogo_test()` implements the Stock and Yogo test for weak instruments. The test developed by Stock and Yogo [-@Stock_2005]
is a decision rule meant to ensure that weak instruments do not pose a problem.
Stock and Yogo suggest two methods to select the critical values: one based on maximum allowable bias relative to normal OLS and another based on the maximum size of a Wald test on all of the instruments.
Both of these decision rules are implemented.

```{r}
stock_yogo_test(
	~X1+X2+X3,	#Controls
	~D,			#Treatments
	~Z1 + Z2,	#Instruments
	B=.1,		#Maximum Allowable Size Distortion
	size_bias="size", #Calculate critical value for size distortions
	data =example_data
)
```

# References
